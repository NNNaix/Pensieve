# 插入排序

## 1. 思路

插入排序每次排一个数组项，以此方式构建最后的排序数组。假定第一项已经排序了。接着，它和第二项进行比较——第二项是应该待在原位还是插到第一项之前呢？这样，头两项就已正确排序，接着和第三项比较（它是该插入到第一、第二还是第三的位置呢），以此类推。所谓的插入是通过数组相邻项平移实现的。

## 2. 算法步骤

对于长度为 `n` 的数组 `a`，有比较条件 `compareFunc`，数组当前索引指针用 `i` 来表示，当前待排序数组项用 `temp` 来表示，本轮待排序数组项索引用 `k` 来表示：

1. 本轮待排序索引指针 `k` 指向 `1`。
2. 当前索引指针 `i`  指向 `k`。
3. 当前待排序数组项 `temp` 指向 `a[k]`。
4. 对于第 `i` 项如果满足 `i>0 && compareFunc(a[i-1],temp) === Compare.BIGGER_THAN`，则将 `a[i-1]` 赋值给 `a[i]`。
5. 当前索引指针 `i` 指向相邻的下一个索引（`i+1`）。
6. 循环 `4.` `5.` 步骤,直到 `i<0 || compareFunc(a[i-1],temp) === Compare.LESS_THAN`。
7. 将 `temp` 赋值给 `a[i-1]` 。
8. 遍历索引指针 `k` 指向相邻的下一个索引（`k+1`）
9. 循环 `2.` `3.` `4.` `5.` `6.` `7.` `8.` 步骤直到遍历索引指针 `k` 处于数组的第 `n-1` 项的索引上 (`k === n-1`)

## 3. 图示

![example](http://www.ituring.com.cn/figures/2019/JavaScriptLDSA/16.d13z.004.png)

## 4. 代码实现

### 简单实现

```javascript
function OinsertionSort(array, compareFn = defaultCompare) {
    const { length } = array;
    let temp;
    // k 表示本轮待排序的数组项索引，由于默认第一项是已排序的，所以初始值是 1
    for (let k = 1; k < length; k++) {
        // i 表示已排序的数组数量，以此进行倒序遍历
        let i = k;
        // 保存本轮待排序的数组项，在倒序遍历中可能会被平移覆盖
        temp = array[k];
        while (i > 0 && compareFn(array[i - 1], temp) === Compare.BIGGER_THAN) {
            // 当前数组项小于上一项，则用上一项覆盖当前项，实现数值项平移
            array[i] = array[i - 1]; // {6}
            i--;
        }
      // 遍历后 i 指向需要插入的索引位置，使用保存的待排序数组项覆盖插入
      array[i] = temp; // {7}
    }
    return array;
  };
```

## 复杂度

| 平均时间复杂度 | 最好情况 | 最坏情况 | 空间复杂度 | 稳定性 |
| -------------- | -------- | -------- | ---------- | ------ |
| O(n²)          | O(n)     | O(n²)    | O(1)       | 稳定   |
